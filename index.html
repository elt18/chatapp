<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Purwadhika</title>
    <link rel="stylesheet" href="./index.css">
  </head>
  <body>
    <div class="">
      <h1 class="title">Chat App!</h1>
    </div>
    <div class="chatbox">
      <p>TESSSSSSSSSSSSSSSSSSSSSSSSSSSSST</p>
    </div>
    <div class="chatmessage">
      <textarea class="textarea" rows="8" cols="100"></textarea>
      <button type="button" name="button" class="sendbutton">SEND</button>
    </div>

<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCEz-MmGbENBkG8laAw0w_N0RtCldZ-Z7s",
    authDomain: "chatapp-1e4d5.firebaseapp.com",
    databaseURL: "https://chatapp-1e4d5.firebaseio.com",
    projectId: "chatapp-1e4d5",
    storageBucket: "chatapp-1e4d5.appspot.com",
    messagingSenderId: "340861055215"
  };
  firebase.initializeApp(config);
</script>

<script type="text/javascript">
var isClicked = false
     $(".sendbutton").click(function(){
       firebase.database().ref('users/' + new Date()).set(
       {
         chat: ($(".textarea").val())
       }
     );
    });
   firebase.database().ref('users').on('value' , (snapshot) => {
     if (isClicked) {
       $(".chatbox").append("<b>Anonymous:");
       $(".chatbox").append("<br>");
       $(".chatbox").append(snapshot.val()[Object.keys(snapshot.val())[Object.keys(snapshot.val()).length - 1]].chat);
       $(".chatbox").append("<br>");
       $(".chatbox").append("<br>");
     }
     else {
       isClicked = true
     }
   })
</script>

  </body>
</html>
